<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Unit 10: ENERGY SOURCES - The Complete Textbook Edition</title>
<style>
  :root {
    --primary: #F39C12; /* Solar Yellow */
    --secondary: #27AE60; /* Eco Green */
    --bg: #2C3E50; /* Dark Blue */
    --card: #ECF0F1;
    --text: #2C3E50;
    --correct: #27ae60;
    --wrong: #c0392b;
  }

  body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); color: var(--text); padding-bottom: 70px; }
  
  /* HEADER */
  header {
    background: #34495E; padding: 15px 20px; border-bottom: 3px solid var(--primary);
    position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center;
    color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  .brand { font-size: 20px; font-weight: 900; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
  .stats { font-size: 14px; font-weight: bold; }
  .score-box { background: var(--secondary); padding: 5px 12px; border-radius: 15px; color: white; margin-left: 10px; }

  /* CONTAINER */
  .container { max-width: 950px; margin: 25px auto; padding: 0 15px; display: grid; grid-template-columns: 260px 1fr; gap: 25px; }
  @media (max-width: 850px) { .container { grid-template-columns: 1fr; } }

  /* SIDEBAR */
  .sidebar {
    background: #BDC3C7; border-radius: 12px; padding: 15px; height: fit-content;
    position: sticky; top: 90px; border: 1px solid #95A5A6;
    max-height: 80vh; overflow-y: auto;
  }
  .nav-btn {
    display: block; width: 100%; text-align: left; padding: 12px; border: none; background: transparent;
    color: #2C3E50; cursor: pointer; border-radius: 8px; font-size: 14px; margin-bottom: 5px; border-bottom: 1px solid #aaa; font-weight: 600;
  }
  .nav-btn:hover { background: #95A5A6; color: #fff; }
  .nav-btn.active { background: var(--secondary); color: #fff; font-weight: 800; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }

  /* MAIN CONTENT */
  .slide { 
    background: var(--card); padding: 30px; border-radius: 15px; border: 1px solid #BDC3C7;
    min-height: 450px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); animation: fadeIn 0.4s ease-out;
  }
  @keyframes fadeIn { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

  h2 { margin: 0 0 15px 0; color: var(--secondary); font-size: 26px; border-bottom: 2px solid #BDC3C7; padding-bottom: 10px;}
  .desc { color: #7F8C8D; font-style: italic; font-size: 15px; margin-bottom: 25px; }

  /* READING & DIALOGUE SCROLL */
  .scroll-content {
    background: #fff; padding: 20px; border-radius: 10px; max-height: 400px; overflow-y: auto;
    font-size: 16px; line-height: 1.7; border: 1px solid #BDC3C7; margin-bottom: 20px; color: #2C3E50;
  }
  .line { padding: 10px; border-radius: 6px; margin-bottom: 8px; cursor: pointer; border-left: 4px solid transparent; }
  .line:hover { background: #ECF0F1; }
  .line.active { background: #D5F5E3; border-left-color: var(--secondary); font-weight: 600; }
  .role { font-weight: 800; color: var(--primary); text-transform: uppercase; font-size: 12px; margin-right: 8px; }
  .en { display: block; color: #2C3E50; }
  .vi { display: block; font-size: 14px; color: #7F8C8D; margin-top: 4px; font-style: italic; }
  .hidden { display: none !important; }

  /* QUIZ STYLES */
  .q-block { margin-bottom: 35px; border-bottom: 1px dashed #BDC3C7; padding-bottom: 25px; }
  .q-text { font-size: 19px; font-weight: 700; margin-bottom: 12px; color: #2C3E50; }
  .q-vi { font-size: 15px; color: #7F8C8D; margin-bottom: 15px; font-style: italic; }

  /* OPTIONS GRID */
  .opts-grid { display: flex; flex-wrap: wrap; gap: 12px; }
  .opt-btn {
    padding: 14px 20px; background: #fff; border: 2px solid #BDC3C7; border-radius: 12px; color: #2C3E50;
    cursor: pointer; transition: 0.2s; font-size: 15px; font-weight: 600;
    flex: 1 1 45%; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;
  }
  .opt-btn:hover { background: #ECF0F1; border-color: var(--secondary); transform: translateY(-2px); }
  .opt-sub { font-size: 13px; color: #7F8C8D; margin-top: 4px; font-style: italic; font-weight: 400; }

  /* FEEDBACK */
  .opt-btn.correct { background: #D5F5E3; border-color: var(--correct); color: var(--correct); pointer-events: none; }
  .opt-btn.wrong { background: #FADBD8; border-color: var(--wrong); color: var(--wrong); opacity: 0.7; pointer-events: none; }
  
  .expl-box {
    margin-top: 15px; padding: 15px; background: #D6EAF8; border-left: 5px solid var(--secondary);
    border-radius: 6px; font-size: 14px; color: #2C3E50; display: none; animation: slideDown 0.3s;
  }
  .expl-title { font-weight: 800; color: var(--secondary); text-transform: uppercase; font-size: 11px; display: block; margin-bottom: 5px; }
  @keyframes slideDown { from{opacity:0; transform:translateY(-10px)} to{opacity:1; transform:translateY(0)} }

  /* FOOTER */
  .footer {
    position: fixed; bottom: 0; left: 0; width: 100%; background: #34495E;
    padding: 12px; display: flex; justify-content: center; gap: 15px; border-top: 1px solid #2C3E50; z-index: 200;
  }
  .ctrl-btn {
    background: #2C3E50; color: #ECF0F1; border: 1px solid #7F8C8D; padding: 10px 25px; border-radius: 25px;
    cursor: pointer; font-weight: bold; font-size: 13px; transition: 0.2s;
  }
  .ctrl-btn:hover { background: #7F8C8D; }
  .ctrl-btn.active { background: var(--primary); color: #2C3E50; border-color: var(--primary); box-shadow: 0 0 10px rgba(241, 196, 15, 0.5); }
  .ctrl-btn.music-on { background: #9B59B6; border-color: #9B59B6; animation: glow 1.5s infinite; color: white; }
  @keyframes glow { 0%{box-shadow:0 0 5px #9B59B6;} 50%{box-shadow:0 0 15px #9B59B6;} 100%{box-shadow:0 0 5px #9B59B6;} }

  .next-btn {
    background: var(--secondary); color: white; padding: 12px; width: 100%; border: none;
    border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 20px; display: none; font-size: 16px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }
  .next-btn:hover { background: #1E8449; }

  /* Responsive */
  @media (max-width: 600px) {
    .slide { padding: 15px; }
    .opts-grid { flex-direction: column; }
    .opt-btn { flex: 1 1 100%; }
  }
</style>
</head>
<body>

<header>
  <div class="brand">UNIT 10: ENERGY</div>
  <div class="stats">
    Ti·∫øn ƒë·ªô: <span id="qCount">0</span>/<span id="totalQ">0</span> 
    <span class="score-box">ƒêi·ªÉm: <span id="score">0</span></span>
  </div>
</header>

<div class="container">
  <aside class="sidebar" id="sidebar">
    </aside>

  <main id="main">
    </main>
</div>

<div class="footer">
  <button class="ctrl-btn" id="btnMusic" onclick="toggleMusic()">üéµ Nh·∫°c: OFF</button>
  <button class="ctrl-btn active" id="btnVi" onclick="toggleVi()">üáªüá≥ D·ªãch: ON</button>
  <button class="ctrl-btn" onclick="if(confirm('L√†m l·∫°i t·ª´ ƒë·∫ßu?')) location.reload()">‚Üª Reset</button>
</div>

<script>
/* ==========================================================================
   DATABASE (COMPLETE UNIT 10 - Global Success 7)
   Full Content from P.105-109
   ========================================================================== */
const DATA = [
  // --- SECTION 1: GETTING STARTED ---
  {
    id: "gs_read", title: "1. Getting Started", desc: "Types of energy sources", type: "dialogue",
    script: [
      {r:"Lan", e:"Hi, Dad.", v:"Ch√†o b·ªë."},
      {r:"Mr Tan", e:"Lan, what are you doing? It's pretty late now.", v:"Lan, con ƒëang l√†m g√¨ ƒë·∫•y? Mu·ªôn r·ªìi ƒë√≥."},
      {r:"Lan", e:"I'm doing a project on energy sources. But I don't quite understand what energy is.", v:"Con ƒëang l√†m d·ª± √°n v·ªÅ c√°c ngu·ªìn nƒÉng l∆∞·ª£ng. Nh∆∞ng con ch∆∞a hi·ªÉu l·∫Øm nƒÉng l∆∞·ª£ng l√† g√¨."},
      {r:"Mr Tan", e:"Well, it's power that we use to provide us with light, heat or electricity.", v:"√Ä, ƒë√≥ l√† s·ª©c m·∫°nh ch√∫ng ta d√πng ƒë·ªÉ cung c·∫•p √°nh s√°ng, nhi·ªát ho·∫∑c ƒëi·ªán."},
      {r:"Lan", e:"Oh. Where does it come from?", v:"·ªí. N√≥ ƒë·∫øn t·ª´ ƒë√¢u ·∫°?"},
      {r:"Mr Tan", e:"It comes from many different sources like coal, oil, natural gas,... We call them non-renewable sources.", v:"N√≥ ƒë·∫øn t·ª´ nhi·ªÅu ngu·ªìn nh∆∞ than ƒë√°, d·∫ßu m·ªè, kh√≠ ƒë·ªët... Ta g·ªçi ch√∫ng l√† ngu·ªìn kh√¥ng t√°i t·∫°o."},
      {r:"Lan", e:"Can it come from the sun, wind or water too?", v:"N√≥ c√≥ ƒë·∫øn t·ª´ m·∫∑t tr·ªùi, gi√≥ hay n∆∞·ªõc kh√¥ng ·∫°?"},
      {r:"Mr Tan", e:"Yes, it can. We call those types of energy renewable sources because we cannot run out of them. Renewable means we can easily replace them.", v:"C√≥ ch·ª©. Ta g·ªçi ƒë√≥ l√† nƒÉng l∆∞·ª£ng t√°i t·∫°o v√¨ ta kh√¥ng d√πng c·∫°n ki·ªát ch√∫ng ƒë∆∞·ª£c. T√°i t·∫°o nghƒ©a l√† ta c√≥ th·ªÉ d·ªÖ d√†ng thay th·∫ø ch√∫ng."},
      {r:"Lan", e:"I get it now.", v:"Con hi·ªÉu r·ªìi."},
      {r:"Mr Tan", e:"You know, some types of energy are cheap and easy to use, but others are more expensive and harder to find...", v:"Con bi·∫øt kh√¥ng, m·ªôt s·ªë lo·∫°i th√¨ r·∫ª v√† d·ªÖ d√πng, nh∆∞ng s·ªë kh√°c th√¨ ƒë·∫Øt v√† kh√≥ t√¨m h∆°n..."}
    ]
  },
  {
    id: "gs_ex2", title: "Getting Started - Ex 2", desc: "What are they talking about?", type: "quiz",
    qs: [
      {q:"What are Lan and her father talking about?", v:"Lan v√† b·ªë ƒëang n√≥i v·ªÅ chuy·ªán g√¨?", o:[{t:"A. Energy",v:"NƒÉng l∆∞·ª£ng"},{t:"B. Sources",v:"C√°c ngu·ªìn"},{t:"C. Energy sources",v:"C√°c ngu·ªìn nƒÉng l∆∞·ª£ng"}], a:2, e:"Ti√™u ƒë·ªÅ b√†i h·ªçc v√† n·ªôi dung ch√≠nh xoay quanh 'Energy sources'."}
    ]
  },
  {
    id: "gs_ex3", title: "Getting Started - Ex 3", desc: "Answer the questions", type: "quiz",
    qs: [
      {q:"1. What is Lan doing?", v:"Lan ƒëang l√†m g√¨?", o:[{t:"Doing a project",v:"L√†m d·ª± √°n"},{t:"Watching TV",v:""},{t:"Sleeping",v:""}], a:0, e:"Lan n√≥i: 'I'm doing a project on energy sources'."},
      {q:"2. What does energy mean?", v:"NƒÉng l∆∞·ª£ng nghƒ©a l√† g√¨?", o:[{t:"Power for light, heat, electricity",v:"NƒÉng l∆∞·ª£ng cho √°nh s√°ng..."},{t:"Water source",v:""},{t:"Wind power",v:""}], a:0, e:"Mr Tan: 'power that we use to provide us with light...'"},
      {q:"3. Where does energy come from?", v:"NƒÉng l∆∞·ª£ng ƒë·∫øn t·ª´ ƒë√¢u?", o:[{t:"Many different sources",v:"Nhi·ªÅu ngu·ªìn kh√°c nhau"},{t:"Only the sun",v:""},{t:"Only coal",v:""}], a:0, e:"Mr Tan: 'It comes from many different sources...'"},
      {q:"4. What are renewable sources?", v:"Ngu·ªìn t√°i t·∫°o l√† g√¨?", o:[{t:"Sun, wind, water",v:"M·∫∑t tr·ªùi, gi√≥, n∆∞·ªõc"},{t:"Coal, oil, gas",v:""},{t:"Electricity",v:""}], a:0, e:"Lan h·ªèi v·ªÅ sun, wind, water v√† b·ªë x√°c nh·∫≠n."}
    ]
  },
  {
    id: "gs_ex4", title: "Getting Started - Ex 4", desc: "Match pictures", type: "quiz",
    qs: [
      {q:"Picture a (Wind turbines) matches with:", v:"H√¨nh a (Tua bin gi√≥) n·ªëi v·ªõi:", o:[{t:"2. wind energy",v:"nƒÉng l∆∞·ª£ng gi√≥"},{t:"1. oil",v:""},{t:"3. coal",v:""},{t:"4. natural gas",v:""}], a:0, e:"H√¨nh ·∫£nh c√°c tua bin gi√≥."},
      {q:"Picture b (Factory smoke) matches with:", v:"H√¨nh b (Nh√† m√°y kh√≥i) n·ªëi v·ªõi:", o:[{t:"3. coal",v:"than ƒë√°"},{t:"2. wind energy",v:""},{t:"1. oil",v:""},{t:"4. natural gas",v:""}], a:0, e:"Nh√† m√°y nhi·ªát ƒëi·ªán than."},
      {q:"Picture c (Flaring pipes) matches with:", v:"H√¨nh c (·ªêng d·∫´n l·ª≠a) n·ªëi v·ªõi:", o:[{t:"4. natural gas",v:"kh√≠ t·ª± nhi√™n"},{t:"2. wind energy",v:""},{t:"3. coal",v:""},{t:"1. oil",v:""}], a:0, e:"Bi·ªÉu t∆∞·ª£ng khai th√°c kh√≠ ƒë·ªët."},
      {q:"Picture d (Red barrels) matches with:", v:"H√¨nh d (Th√πng ƒë·ªè) n·ªëi v·ªõi:", o:[{t:"1. oil",v:"d·∫ßu m·ªè"},{t:"4. natural gas",v:""},{t:"3. coal",v:""},{t:"2. wind energy",v:""}], a:0, e:"Th√πng ch·ª©a d·∫ßu."}
    ]
  },
  {
    id: "gs_ex5", title: "Getting Started - Ex 5", desc: "Complete sentences (Word Bank)", type: "quiz",
    qs: [
      {q:"1. Energy is ______ that we use to provide us with light, heat or electricity.", v:"NƒÉng l∆∞·ª£ng l√† ______ ch√∫ng ta d√πng...", o:[{t:"power",v:"s·ª©c m·∫°nh"},{t:"water",v:""},{t:"source",v:""}], a:0, e:"Mr Tan: 'it's power that we use...'"},
      {q:"2. When energy comes from the ______, wind and water, we call it renewable energy.", v:"Khi nƒÉng l∆∞·ª£ng ƒë·∫øn t·ª´ ______, gi√≥ v√† n∆∞·ªõc...", o:[{t:"sun",v:"m·∫∑t tr·ªùi"},{t:"moon",v:""},{t:"earth",v:""}], a:0, e:"Mr Tan: 'come from the sun, wind, or water'."},
      {q:"3. When energy comes from wind, we call it ______ energy.", v:"NƒÉng l∆∞·ª£ng t·ª´ gi√≥ g·ªçi l√†...", o:[{t:"wind",v:"gi√≥"},{t:"solar",v:""},{t:"hydro",v:""}], a:0, e:"Wind -> Wind energy."},
      {q:"4. We cannot ______ out of renewable energy.", v:"Ch√∫ng ta kh√¥ng th·ªÉ ______ h·∫øt nƒÉng l∆∞·ª£ng t√°i t·∫°o.", o:[{t:"run",v:"c·∫°n ki·ªát (run out)"},{t:"walk",v:""},{t:"use",v:""}], a:0, e:"Mr Tan: 'we cannot run out of them'."},
      {q:"5. Some types of energy are ______ and easy to use.", v:"M·ªôt s·ªë lo·∫°i th√¨ ______ v√† d·ªÖ d√πng.", o:[{t:"cheap",v:"r·∫ª"},{t:"expensive",v:"ƒë·∫Øt"},{t:"hard",v:""}], a:0, e:"Mr Tan: 'some types of energy are cheap and easy to use'."}
    ]
  },

  // --- A CLOSER LOOK 1 ---
  {
    id: "cl1_ex1", title: "2. A Closer Look 1 - Ex 1", desc: "Match Types & Sources", type: "quiz",
    qs: [
      {q:"1. solar energy - Match with:", v:"NƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi - N·ªëi v·ªõi:", o:[{t:"d. the sun",v:"m·∫∑t tr·ªùi"},{t:"a. water",v:""},{t:"c. wind",v:""}], a:0, e:"Solar -> Sun."},
      {q:"2. wind energy - Match with:", v:"NƒÉng l∆∞·ª£ng gi√≥ - N·ªëi v·ªõi:", o:[{t:"c. wind",v:"gi√≥"},{t:"b. nuclear",v:""},{t:"a. water",v:""}], a:0, e:"Wind -> Wind."},
      {q:"3. hydro energy - Match with:", v:"Th·ªßy ƒëi·ªán - N·ªëi v·ªõi:", o:[{t:"a. water",v:"n∆∞·ªõc"},{t:"d. the sun",v:""},{t:"c. wind",v:""}], a:0, e:"Hydro -> Water."},
      {q:"4. nuclear energy - Match with:", v:"NƒÉng l∆∞·ª£ng h·∫°t nh√¢n - N·ªëi v·ªõi:", o:[{t:"b. nuclear",v:"nguy√™n t·ª≠"},{t:"c. wind",v:""},{t:"d. the sun",v:""}], a:0, e:"Nuclear -> Nuclear sources."}
    ]
  },
  {
    id: "cl1_ex2", title: "A Closer Look 1 - Ex 2", desc: "Label the pictures (Word Bank)", type: "quiz",
    qs: [
      {q:"Picture 1: Factory with towers emitting smoke/steam.", v:"H√¨nh 1: Nh√† m√°y c√≥ th√°p kh√≥i.", o:[{t:"nuclear energy",v:"nƒÉng l∆∞·ª£ng h·∫°t nh√¢n"},{t:"wind energy",v:""},{t:"hydro energy",v:""}], a:0, e:"H√¨nh ·∫£nh ƒë·∫∑c tr∆∞ng c·ªßa nh√† m√°y ƒëi·ªán h·∫°t nh√¢n."},
      {q:"Picture 2: Dam with water flowing.", v:"H√¨nh 2: ƒê·∫≠p n∆∞·ªõc.", o:[{t:"hydro energy",v:"th·ªßy ƒëi·ªán"},{t:"solar energy",v:""},{t:"coal",v:""}], a:0, e:"ƒê·∫≠p th·ªßy ƒëi·ªán (Hydro)."},
      {q:"Picture 3: Solar panels.", v:"H√¨nh 3: Pin m·∫∑t tr·ªùi.", o:[{t:"solar energy",v:"nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi"},{t:"nuclear energy",v:""},{t:"wind energy",v:""}], a:0, e:"T·∫•m pin nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi."},
      {q:"Picture 4: Wind turbines.", v:"H√¨nh 4: Tua bin gi√≥.", o:[{t:"wind energy",v:"nƒÉng l∆∞·ª£ng gi√≥"},{t:"solar energy",v:""},{t:"oil",v:""}], a:0, e:"C√°nh qu·∫°t gi√≥ (Wind turbines)."}
    ]
  },
  {
    id: "cl1_ex3", title: "A Closer Look 1 - Ex 3", desc: "Complete Sentences (Word Bank)", type: "quiz",
    qs: [
      {q:"1. A good place to change ______ to energy is near the sea because of sea breezes.", v:"N∆°i t·ªët ƒë·ªÉ chuy·ªÉn ______ th√†nh nƒÉng l∆∞·ª£ng l√† g·∫ßn bi·ªÉn...", o:[{t:"wind",v:"gi√≥"},{t:"solar",v:""},{t:"hydro",v:""}], a:0, e:"Sea breezes (gi√≥ bi·ªÉn) -> Wind."},
      {q:"2. They are putting solar panels on the roof to produce ______.", v:"H·ªç ƒë·∫∑t pin m·∫∑t tr·ªùi ƒë·ªÉ s·∫£n xu·∫•t...", o:[{t:"solar energy",v:"nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi"},{t:"wind energy",v:""},{t:"water",v:""}], a:0, e:"Solar panels -> Solar energy."},
      {q:"3. When energy comes from ______, we call it hydro energy.", v:"Khi nƒÉng l∆∞·ª£ng t·ª´ ______, g·ªçi l√† th·ªßy ƒëi·ªán.", o:[{t:"water",v:"n∆∞·ªõc"},{t:"sun",v:""},{t:"wind",v:""}], a:0, e:"Hydro -> Water."},
      {q:"4. They are reducing the use of ______ because it is not safe to produce.", v:"H·ªç gi·∫£m d√πng ______ v√¨ kh√¥ng an to√†n.", o:[{t:"nuclear energy",v:"nƒÉng l∆∞·ª£ng h·∫°t nh√¢n"},{t:"solar energy",v:""},{t:"wind energy",v:""}], a:0, e:"Nuclear energy th∆∞·ªùng ƒë∆∞·ª£c coi l√† r·ªßi ro (not safe)."}
    ]
  },
  {
    id: "cl1_pron", title: "A Closer Look 1 - Pronunciation", desc: "Stress in 3-syllable words", type: "quiz",
    qs: [
      {q:"4a. 'energy - Stress is on:", v:"Tr·ªçng √¢m t·ª´ 'energy' r∆°i v√†o...", o:[{t:"1st syllable",v:"√¢m 1"},{t:"2nd syllable",v:"√¢m 2"},{t:"3rd syllable",v:"√¢m 3"}], a:0, e:"'En-er-gy' (1)."},
      {q:"4b. 'dangerous - Stress is on:", v:"Tr·ªçng √¢m t·ª´ 'dangerous' r∆°i v√†o...", o:[{t:"1st syllable",v:"√¢m 1"},{t:"2nd syllable",v:""},{t:"3rd syllable",v:""}], a:0, e:"'Dan-ge-rous' (1)."},
      {q:"4c. 'easily - Stress is on:", v:"Tr·ªçng √¢m t·ª´ 'easily' r∆°i v√†o...", o:[{t:"1st syllable",v:"√¢m 1"},{t:"2nd syllable",v:""},{t:"3rd syllable",v:""}], a:0, e:"'Ea-si-ly' (1)."},
      {q:"4d. ex'pensive - Stress is on:", v:"Tr·ªçng √¢m t·ª´ 'expensive' r∆°i v√†o...", o:[{t:"2nd syllable",v:"√¢m 2"},{t:"1st syllable",v:""},{t:"3rd syllable",v:""}], a:0, e:"'Ex-pen-sive' (2)."}
    ]
  },

  // --- A CLOSER LOOK 2 ---
  {
    id: "cl2_ex2", title: "3. A Closer Look 2 - Ex 2", desc: "Present Continuous (Form)", type: "quiz",
    qs: [
      {q:"1. Mai (talk) ______ about types of energy sources now.", v:"Mai ƒëang n√≥i...", o:[{t:"is talking",v:""},{t:"talks",v:""},{t:"are talking",v:""}], a:0, e:"'now' -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. Mai (s·ªë √≠t) -> is talking."},
      {q:"2. We (use) ______ solar energy to replace energy from coal today.", v:"Ch√∫ng ta ƒëang d√πng...", o:[{t:"are using",v:""},{t:"use",v:""},{t:"is using",v:""}], a:0, e:"'today' (xu h∆∞·ªõng hi·ªán nay) -> are using."},
      {q:"3. Keep quiet! The students of Class 7C (take) ______ a test.", v:"Tr·∫≠t t·ª±! H·ªçc sinh ƒëang l√†m b√†i...", o:[{t:"are taking",v:""},{t:"take",v:""},{t:"is taking",v:""}], a:0, e:"'Keep quiet!' -> H√†nh ƒë·ªông ƒëang x·∫£y ra. Students (s·ªë nhi·ªÅu) -> are taking."},
      {q:"4. Scientists (develop) ______ new energy sources.", v:"C√°c nh√† khoa h·ªçc ƒëang ph√°t tri·ªÉn...", o:[{t:"are developing",v:""},{t:"develop",v:""},{t:"is developing",v:""}], a:0, e:"Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang di·ªÖn ra. Scientists -> are developing."},
      {q:"5. We (reduce) ______ the use of nuclear energy nowadays.", v:"Ng√†y nay ch√∫ng ta ƒëang gi·∫£m...", o:[{t:"are reducing",v:""},{t:"reduce",v:""},{t:"is reducing",v:""}], a:0, e:"'nowadays' (xu h∆∞·ªõng) -> are reducing."}
    ]
  },
  {
    id: "cl2_ex3", title: "A Closer Look 2 - Ex 3", desc: "Circle correct form", type: "quiz",
    qs: [
      {q:"1. Are you still ______ on your project now?", v:"B·∫°n v·∫´n ƒëang l√†m d·ª± √°n √†?", o:[{t:"working",v:""},{t:"work",v:""}], a:0, e:"C√¢u h·ªèi ti·∫øp di·ªÖn 'Are you...' -> V-ing."},
      {q:"2. Nam and Lan ______ quite well at school this year.", v:"Nam v√† Lan h·ªçc kh√° t·ªët nƒÉm nay.", o:[{t:"are doing",v:""},{t:"do",v:""}], a:0, e:"'this year' (t·∫°m th·ªùi/xu h∆∞·ªõng) -> are doing."},
      {q:"3. ______ she ______ at the school library at the moment?", v:"C√¥ ·∫•y ƒëang h·ªçc...?", o:[{t:"Is / studying",v:""},{t:"Does / study",v:""}], a:0, e:"'at the moment' -> Is she studying."},
      {q:"4. Hoa ______ for her exam, so she can't come to the party right now.", v:"Hoa ƒëang h·ªçc...", o:[{t:"is studying",v:""},{t:"studies",v:""}], a:0, e:"'right now' -> is studying."},
      {q:"5. We ______ English three times a week.", v:"Ch√∫ng t√¥i h·ªçc ti·∫øng Anh 3 l·∫ßn/tu·∫ßn.", o:[{t:"have",v:""},{t:"are having",v:""}], a:0, e:"'three times a week' (l·ªãch tr√¨nh/th√≥i quen) -> Hi·ªán t·∫°i ƒë∆°n (have)."}
    ]
  },
  {
    id: "cl2_ex4", title: "A Closer Look 2 - Ex 4", desc: "Write Sentences (Word Bank)", type: "quiz",
    qs: [
      {q:"1. The students / do the project / now.", v:"H·ªçc sinh ƒëang l√†m d·ª± √°n.", o:[{t:"The students are doing the project now.",v:""},{t:"The students do the project now.",v:""}], a:0, e:"'now' -> are doing."},
      {q:"2. Mrs Lien / teach us about solar energy / at the moment.", v:"C√¥ Li√™n ƒëang d·∫°y...", o:[{t:"Mrs Lien is teaching us...",v:""},{t:"Mrs Lien teaches us...",v:""}], a:0, e:"'at the moment' -> is teaching."},
      {q:"3. They / learn about energy / this month.", v:"H·ªç ƒëang h·ªçc...", o:[{t:"They are learning about energy...",v:""},{t:"They learn about energy...",v:""}], a:0, e:"'this month' -> are learning."},
      {q:"4. She / not swim / in the swimming pool / right now.", v:"C√¥ ·∫•y kh√¥ng b∆°i...", o:[{t:"She isn't swimming...",v:""},{t:"She doesn't swim...",v:""}], a:0, e:"'right now' -> isn't swimming."},
      {q:"5. Nowadays, people in Iceland / not use energy from coal.", v:"Ng∆∞·ªùi Iceland kh√¥ng d√πng than.", o:[{t:"people in Iceland are not using...",v:""},{t:"people in Iceland don't use...",v:""}], a:0, e:"'Nowadays' (xu h∆∞·ªõng) -> are not using."}
    ]
  },

  // --- COMMUNICATION ---
  {
    id: "comm_ex4", title: "4. Communication", desc: "Saving Energy (Word Bank)", type: "quiz",
    qs: [
      {q:"Lan: What does 'solar energy' ______?", v:"Solar energy nghƒ©a l√† g√¨?", o:[{t:"mean",v:"nghƒ©a l√†"},{t:"do",v:""},{t:"make",v:""}], a:0, e:"C·∫•u tr√∫c h·ªèi nghƒ©a: What does ... mean?"},
      {q:"Mr Tan: It's energy that ______ from the sun.", v:"N√≥ l√† nƒÉng l∆∞·ª£ng ƒë·∫øn t·ª´...", o:[{t:"comes",v:"ƒë·∫øn"},{t:"goes",v:""},{t:"makes",v:""}], a:0, e:"Comes from = ƒê·∫øn t·ª´/b·∫Øt ngu·ªìn t·ª´."},
      {q:"Lan: And what does 'wind energy' mean?", v:"Th·∫ø wind energy nghƒ©a l√† g√¨?", o:[{t:"It comes from wind.",v:"N√≥ ƒë·∫øn t·ª´ gi√≥"},{t:"It is water.",v:""}], a:0, e:"Wind energy comes from wind."},
      {q:"Mr Tan: It's another type of energy, and it comes from ______.", v:"N√≥ ƒë·∫øn t·ª´...", o:[{t:"wind",v:"gi√≥"},{t:"sun",v:""},{t:"coal",v:""}], a:0, e:"Wind energy comes from wind."}
    ]
  },

  // --- SKILLS 1 ---
  {
    id: "skills1_read", title: "5. Skills 1 - Reading", desc: "Mr Lam's Lecture", type: "reading",
    content: [
      {e:"Hello class. Today I'd like to tell you about two energy sources. They are non-renewable sources and renewable sources.", v:"Ch√†o c·∫£ l·ªõp. H√¥m nay th·∫ßy s·∫Ω n√≥i v·ªÅ 2 ngu·ªìn nƒÉng l∆∞·ª£ng: kh√¥ng t√°i t·∫°o v√† t√°i t·∫°o."},
      {e:"Non-renewable sources are coal, oil and natural gas. We can use these sources to produce energy. They are cheap and easy to use.", v:"Ngu·ªìn kh√¥ng t√°i t·∫°o g·ªìm than, d·∫ßu, kh√≠ gas. Ta d√πng ch√∫ng ƒë·ªÉ t·∫°o nƒÉng l∆∞·ª£ng. Ch√∫ng r·∫ª v√† d·ªÖ d√πng."},
      {e:"People use them a lot. But they are very limited and will run out soon.", v:"M·ªçi ng∆∞·ªùi d√πng r·∫•t nhi·ªÅu. Nh∆∞ng ch√∫ng c√≥ h·∫°n v√† s·∫Ω s·ªõm c·∫°n ki·ªát."},
      {e:"Renewable sources come from the sun, wind or water. When energy comes from the sun, we call it solar energy.", v:"Ngu·ªìn t√°i t·∫°o ƒë·∫øn t·ª´ m·∫∑t tr·ªùi, gi√≥, n∆∞·ªõc. T·ª´ m·∫∑t tr·ªùi g·ªçi l√† nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi."},
      {e:"Wind energy comes from the wind, and hydro energy comes from water.", v:"NƒÉng l∆∞·ª£ng gi√≥ t·ª´ gi√≥, th·ªßy ƒëi·ªán t·ª´ n∆∞·ªõc."},
      {e:"Renewable sources are available, clean and safe to use. But they are expensive to produce.", v:"Ngu·ªìn t√°i t·∫°o c√≥ s·∫µn, s·∫°ch v√† an to√†n. Nh∆∞ng s·∫£n xu·∫•t th√¨ ƒë·∫Øt ƒë·ªè."},
      {e:"In the future we will rely more on renewable energy sources. They are better for the environment and they will not run out.", v:"Trong t∆∞∆°ng lai ta s·∫Ω d·ª±a nhi·ªÅu h∆°n v√†o nƒÉng l∆∞·ª£ng t√°i t·∫°o. Ch√∫ng t·ªët cho m√¥i tr∆∞·ªùng v√† kh√¥ng c·∫°n ki·ªát."}
    ]
  },
  {
    id: "skills1_ex2", title: "Skills 1 - Ex 2", desc: "Choose best option", type: "quiz",
    qs: [
      {q:"1. Non-renewable sources are cheap and ______.", v:"Ngu·ªìn kh√¥ng t√°i t·∫°o r·∫ª v√†...", o:[{t:"B. easy to use",v:"d·ªÖ d√πng"},{t:"A. available",v:""},{t:"C. expensive",v:""}], a:0, e:"B√†i ƒë·ªçc: 'cheap and easy to use'."},
      {q:"2. ______ come from the sun, wind or water.", v:"...ƒë·∫øn t·ª´ m·∫∑t tr·ªùi, gi√≥, n∆∞·ªõc.", o:[{t:"A. Renewable sources",v:"Ngu·ªìn t√°i t·∫°o"},{t:"B. All energy sources",v:""},{t:"C. Non-renewable",v:""}], a:0, e:"B√†i ƒë·ªçc: 'Renewable sources come from...'."},
      {q:"3. When energy comes from water, we call it ______.", v:"NƒÉng l∆∞·ª£ng t·ª´ n∆∞·ªõc g·ªçi l√†...", o:[{t:"C. hydro energy",v:"th·ªßy ƒëi·ªán"},{t:"A. wind energy",v:""},{t:"B. solar energy",v:""}], a:0, e:"B√†i ƒë·ªçc: 'hydro energy comes from water'."},
      {q:"4. Renewable energy sources are better for ______.", v:"T·ªët h∆°n cho...", o:[{t:"A. the environment",v:"m√¥i tr∆∞·ªùng"},{t:"B. our cars",v:""},{t:"C. hydro energy",v:""}], a:0, e:"B√†i ƒë·ªçc: 'better for the environment'."}
    ]
  },
  {
    id: "skills1_ex3", title: "Skills 1 - Ex 3", desc: "Comprehension Questions", type: "quiz",
    qs: [
      {q:"1. How many energy sources are there?", v:"C√≥ bao nhi√™u lo·∫°i?", o:[{t:"Two",v:"Hai"},{t:"Three",v:""},{t:"One",v:""}], a:0, e:"'two energy sources: non-renewable and renewable'."},
      {q:"2. What do non-renewable sources include?", v:"Ngu·ªìn kh√¥ng t√°i t·∫°o g·ªìm g√¨?", o:[{t:"Coal, oil, natural gas",v:"Than, d·∫ßu, kh√≠"},{t:"Sun, wind",v:""},{t:"Water",v:""}], a:0, e:"'coal, oil and natural gas'."},
      {q:"3. What are advantages of renewable energy?", v:"∆Øu ƒëi·ªÉm ngu·ªìn t√°i t·∫°o?", o:[{t:"Clean and safe",v:"S·∫°ch v√† an to√†n"},{t:"Cheap",v:""},{t:"Easy",v:""}], a:0, e:"'available, clean and safe to use'."},
      {q:"4. What will we rely on in the future?", v:"T∆∞∆°ng lai d·ª±a v√†o g√¨?", o:[{t:"Renewable energy",v:"NƒÉng l∆∞·ª£ng t√°i t·∫°o"},{t:"Coal",v:""},{t:"Oil",v:""}], a:0, e:"'rely more on renewable energy sources'."}
    ]
  },

  // --- SKILLS 2 ---
  {
    id: "skills2_listen", title: "6. Skills 2 - Listening", desc: "Saving Energy (Dialogue)", type: "dialogue",
    script: [
      {r:"Mr Lam", e:"We use a lot of energy at home and it costs us a lot. To save energy, we should...", v:"Ch√∫ng ta d√πng nhi·ªÅu nƒÉng l∆∞·ª£ng ·ªü nh√† v√† t·ªën k√©m. ƒê·ªÉ ti·∫øt ki·ªám, ta n√™n..."},
      {r:"Student 1", e:"Turn off the lights.", v:"T·∫Øt ƒë√®n ·∫°."},
      {r:"Mr Lam", e:"Right. Turn off the lights when leaving the room.", v:"ƒê√∫ng. T·∫Øt ƒë√®n khi r·ªùi ph√≤ng."},
      {r:"Student 2", e:"Use low energy light bulbs.", v:"D√πng b√≥ng ƒë√®n ti·∫øt ki·ªám ƒëi·ªán."},
      {r:"Mr Lam", e:"Yes. Use low energy light bulbs at home.", v:"ƒê√∫ng. D√πng b√≥ng ti·∫øt ki·ªám ·ªü nh√†."},
      {r:"Student 3", e:"Use solar panels to warm water.", v:"D√πng pin m·∫∑t tr·ªùi l√†m n√≥ng n∆∞·ªõc."},
      {r:"Mr Lam", e:"Good idea. Use solar energy to warm water.", v:"√ù hay. D√πng nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi l√†m n√≥ng n∆∞·ªõc."},
      {r:"Student 4", e:"Turn off electrical appliances when not using them.", v:"T·∫Øt thi·∫øt b·ªã ƒëi·ªán khi kh√¥ng d√πng."},
      {r:"Mr Lam", e:"Exactly. Turn off the TV or radio when not watching or listening.", v:"Ch√≠nh x√°c. T·∫Øt TV, ƒë√†i khi kh√¥ng xem/nghe."}
    ]
  },
  {
    id: "skills2_ex2", title: "Skills 2 - Ex 2", desc: "Listen and Circle phrases", type: "quiz",
    qs: [
      {q:"Phrase 1: 'turn off the lights'. Did you hear it?", v:"C√≥ nghe th·∫•y kh√¥ng?", o:[{t:"Yes",v:"C√≥"},{t:"No",v:"Kh√¥ng"}], a:0, e:"C√≥ xu·∫•t hi·ªán trong b√†i."},
      {q:"Phrase 2: 'save money'. Did you hear it?", v:"C√≥ nghe th·∫•y kh√¥ng?", o:[{t:"No",v:"Kh√¥ng"},{t:"Yes",v:"C√≥"}], a:0, e:"Kh√¥ng xu·∫•t hi·ªán (ch·ªâ n√≥i costs a lot)."},
      {q:"Phrase 3: 'use low energy light bulbs'. Did you hear it?", v:"C√≥ nghe th·∫•y kh√¥ng?", o:[{t:"Yes",v:"C√≥"},{t:"No",v:"Kh√¥ng"}], a:0, e:"C√≥ xu·∫•t hi·ªán."},
      {q:"Phrase 4: 'produce electricity'. Did you hear it?", v:"C√≥ nghe th·∫•y kh√¥ng?", o:[{t:"No",v:"Kh√¥ng"},{t:"Yes",v:"C√≥"}], a:0, e:"Kh√¥ng xu·∫•t hi·ªán."},
      {q:"Phrase 6: 'use solar panels'. Did you hear it?", v:"C√≥ nghe th·∫•y kh√¥ng?", o:[{t:"Yes",v:"C√≥"},{t:"No",v:"Kh√¥ng"}], a:0, e:"C√≥ xu·∫•t hi·ªán (Use solar panels to warm water)."}
    ]
  },
  {
    id: "skills2_ex3", title: "Skills 2 - Ex 3", desc: "True or False", type: "quiz",
    qs: [
      {q:"1. Mr Lam says we use energy for cooking, heating and lighting.", v:"√îng L√¢m n√≥i d√πng nƒÉng l∆∞·ª£ng ƒë·ªÉ n·∫•u, s∆∞·ªüi, th·∫Øp s√°ng.", o:[{t:"False",v:"Sai"},{t:"True",v:"ƒê√∫ng"}], a:0, e:"√îng L√¢m ch·ªâ n√≥i: 'We use a lot of energy at home...' (kh√¥ng li·ªát k√™ c·ª• th·ªÉ m·ª•c ƒë√≠ch)."},
      {q:"2. Linh always turns off the lights when going out.", v:"Linh lu√¥n t·∫Øt ƒë√®n khi ra ngo√†i.", o:[{t:"True",v:"ƒê√∫ng"},{t:"False",v:"Sai"}], a:0, e:"Linh (Student 1) ƒë·ªÅ xu·∫•t √Ω ki·∫øn, ng·ª• √Ω l√† vi·ªác n√™n l√†m."},
      {q:"3. Linh turns off electrical appliances when not using them.", v:"Linh t·∫Øt thi·∫øt b·ªã ƒëi·ªán khi kh√¥ng d√πng.", o:[{t:"True",v:"ƒê√∫ng"},{t:"False",v:"Sai"}], a:0, e:"ƒê√∫ng (Student 4)."},
      {q:"4. Minh uses low energy light bulbs at his house.", v:"Minh d√πng b√≥ng ƒë√®n ti·∫øt ki·ªám.", o:[{t:"True",v:"ƒê√∫ng"},{t:"False",v:"Sai"}], a:0, e:"ƒê√∫ng (Student 2)."},
      {q:"5. Minh uses solar energy to cook meals.", v:"Minh d√πng nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi n·∫•u ƒÉn.", o:[{t:"False",v:"Sai"},{t:"True",v:"ƒê√∫ng"}], a:0, e:"Sai. B√†i n√≥i 'warm water' (l√†m n√≥ng n∆∞·ªõc), kh√¥ng ph·∫£i 'cook meals'."}
    ]
  },

  // --- LOOKING BACK ---
  {
    id: "lb_ex1", title: "7. Looking Back - Ex 1", desc: "Match Adjectives & Nouns", type: "quiz",
    qs: [
      {q:"1. solar ______", v:"N·ªëi t·ª´...", o:[{t:"e. energy",v:"nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi"},{t:"a. water",v:""}], a:0, e:"Solar energy."},
      {q:"2. hot ______", v:"N·ªëi t·ª´...", o:[{t:"a. water",v:"n∆∞·ªõc n√≥ng"},{t:"e. energy",v:""}], a:0, e:"Hot water."},
      {q:"3. electrical ______", v:"N·ªëi t·ª´...", o:[{t:"d. appliances",v:"thi·∫øt b·ªã ƒëi·ªán"},{t:"b. energy sources",v:""}], a:0, e:"Electrical appliances."},
      {q:"4. renewable ______", v:"N·ªëi t·ª´...", o:[{t:"b. energy sources",v:"ngu·ªìn t√°i t·∫°o"},{t:"c. energy light bulbs",v:""}], a:0, e:"Renewable energy sources."},
      {q:"5. low ______", v:"N·ªëi t·ª´...", o:[{t:"c. energy light bulbs",v:"b√≥ng ti·∫øt ki·ªám"},{t:"d. appliances",v:""}], a:0, e:"Low energy light bulbs."}
    ]
  },
  {
    id: "lb_ex2", title: "Looking Back - Ex 2", desc: "Complete Sentences", type: "quiz",
    qs: [
      {q:"1. We should use ______ in our homes to save energy.", v:"N√™n d√πng ______ ƒë·ªÉ ti·∫øt ki·ªám ƒëi·ªán.", o:[{t:"low energy light bulbs",v:"b√≥ng ti·∫øt ki·ªám"},{t:"hot water",v:""},{t:"solar energy",v:""}], a:0, e:"D√πng b√≥ng ti·∫øt ki·ªám ƒë·ªÉ ti·∫øt ki·ªám ƒëi·ªán."},
      {q:"2. Do they always turn off the ______ before leaving the room?", v:"C√≥ t·∫Øt ______ tr∆∞·ªõc khi ƒëi kh√¥ng?", o:[{t:"electrical appliances",v:"thi·∫øt b·ªã ƒëi·ªán"},{t:"water",v:""},{t:"sun",v:""}], a:0, e:"T·∫Øt thi·∫øt b·ªã ƒëi·ªán."},
      {q:"3. We can protect the environment by using ______.", v:"B·∫£o v·ªá m√¥i tr∆∞·ªùng b·∫±ng c√°ch d√πng...", o:[{t:"renewable energy sources",v:"ngu·ªìn t√°i t·∫°o"},{t:"coal",v:""},{t:"oil",v:""}], a:0, e:"Ngu·ªìn t√°i t·∫°o t·ªët cho m√¥i tr∆∞·ªùng."},
      {q:"4. When energy comes from the sun, we call it ______.", v:"NƒÉng l∆∞·ª£ng t·ª´ m·∫∑t tr·ªùi g·ªçi l√†...", o:[{t:"solar energy",v:"nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi"},{t:"wind energy",v:""}], a:0, e:"Sun -> Solar energy."},
      {q:"5. She has ______ day and night because she has solar panels.", v:"C√¥ ·∫•y c√≥ ______ ng√†y ƒë√™m nh·ªù pin m·∫∑t tr·ªùi.", o:[{t:"hot water",v:"n∆∞·ªõc n√≥ng"},{t:"cold water",v:""}], a:0, e:"Pin m·∫∑t tr·ªùi th∆∞·ªùng d√πng ƒë·ªÉ l√†m n√≥ng n∆∞·ªõc (solar water heater)."}
    ]
  },
  {
    id: "lb_ex3", title: "Looking Back - Ex 3", desc: "Correct Verb Form", type: "quiz",
    qs: [
      {q:"1. Look! It (rain) ______ heavily.", v:"Nh√¨n k√¨a! Tr·ªùi ƒëang m∆∞a to.", o:[{t:"is raining",v:""},{t:"rains",v:""}], a:0, e:"'Look!' -> Hi·ªán t·∫°i ti·∫øp di·ªÖn."},
      {q:"2. Normally they (start) ______ school at eight.", v:"Th√¥ng th∆∞·ªùng h·ªç b·∫Øt ƒë·∫ßu...", o:[{t:"start",v:""},{t:"are starting",v:""}], a:0, e:"'Normally' -> Hi·ªán t·∫°i ƒë∆°n."},
      {q:"3. He hasn't got a bike... so he (walk) ______ to school this week.", v:"Tu·∫ßn n√†y anh ·∫•y ƒëi b·ªô...", o:[{t:"is walking",v:""},{t:"walks",v:""}], a:0, e:"'this week' (h√†nh ƒë·ªông t·∫°m th·ªùi) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn."},
      {q:"4. He always (do) ______ his homework in the evening.", v:"Anh ·∫•y lu√¥n l√†m...", o:[{t:"does",v:""},{t:"is doing",v:""}], a:0, e:"'always' + th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n."},
      {q:"5. I'm afraid I have no time... I (write) ______ an essay.", v:"T√¥i ƒëang vi·∫øt ti·ªÉu lu·∫≠n.", o:[{t:"am writing",v:""},{t:"write",v:""}], a:0, e:"Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang x·∫£y ra l√∫c n√≥i (have no time now)."}
    ]
  },
  {
    id: "lb_ex4", title: "Looking Back - Ex 4", desc: "Find Mistake", type: "quiz",
    qs: [
      {q:"1. The students do the project in Unit 10 now.", v:"T√¨m l·ªói sai.", o:[{t:"do",v:"sai -> are doing"},{t:"project",v:""},{t:"now",v:""}], a:0, e:"C√≥ 'now' ph·∫£i d√πng 'are doing'."},
      {q:"2. At the moment, the teacher is explain how solar energy works.", v:"T√¨m l·ªói sai.", o:[{t:"is explain",v:"sai -> is explaining"},{t:"works",v:""},{t:"At the moment",v:""}], a:0, e:"Ti·∫øp di·ªÖn ph·∫£i l√† V-ing ('is explaining')."},
      {q:"3. Nowadays, people in Africa is not using energy from natural gas.", v:"T√¨m l·ªói sai.", o:[{t:"is not using",v:"sai -> are not using"},{t:"Nowadays",v:""},{t:"energy",v:""}], a:0, e:"People (s·ªë nhi·ªÅu) -> 'are not using'."},
      {q:"4. They are use wind energy instead of coal.", v:"T√¨m l·ªói sai.", o:[{t:"are use",v:"sai -> use / are using"},{t:"instead of",v:""},{t:"wind energy",v:""}], a:0, e:"Ph·∫£i l√† 'use' (hi·ªán t·∫°i ƒë∆°n) ho·∫∑c 'are using'. 'Are use' l√† sai ng·ªØ ph√°p."},
      {q:"5. We look for a cheap, clean... source of energy now.", v:"T√¨m l·ªói sai.", o:[{t:"look",v:"sai -> are looking"},{t:"cheap",v:""},{t:"now",v:""}], a:0, e:"'now' -> 'are looking'."}
    ]
  }
];

/* ==========================================================================
   GAME ENGINE: MUSIC, TTS, RENDERING
   ========================================================================== */
let totalQ = 0;
let answeredQ = 0;
let score = 0;
let isMusicOn = false;
let isViVisible = true;
let audioCtx, musicInterval;
let synth = window.speechSynthesis;
let voices = [];

// Pre-calc total questions
DATA.forEach(s => { if(s.qs) totalQ += s.qs.length; });

window.onload = () => {
  if (synth.onvoiceschanged !== undefined) synth.onvoiceschanged = () => { voices = synth.getVoices(); };
  setTimeout(() => { voices = synth.getVoices(); }, 500);
  
  document.getElementById('totalQ').innerText = totalQ;
  renderSidebar();
  loadSlide(0);
};

/* --- RENDER SIDEBAR --- */
function renderSidebar() {
  const sb = document.getElementById('sidebar');
  let html = '';
  DATA.forEach((sec, i) => {
    html += `<button class="nav-btn ${i===0?'active':''}" id="nav-${i}" onclick="loadSlide(${i})">
      ${sec.title} <br><span style="font-size:11px; opacity:0.7">${sec.desc}</span>
    </button>`;
  });
  sb.innerHTML = html;
}

/* --- RENDER SLIDE --- */
function loadSlide(idx) {
  stopAudio();
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(`nav-${idx}`).classList.add('active');

  const data = DATA[idx];
  const main = document.getElementById('main');
  
  let html = `<div class="slide">
    <h2>${data.title}</h2>
    <div class="desc">${data.desc}</div>`;

  // TYPE: DIALOGUE
  if (data.type === 'dialogue') {
    html += `
      <div style="margin-bottom:10px;">
        <button class="ctrl-btn active" onclick="playScript(${idx})">‚ñ∂ Nghe h·ªôi tho·∫°i</button>
        <button class="ctrl-btn" onclick="stopAudio()">‚óº D·ª´ng</button>
      </div>
      <div class="scroll-content">`;
    data.script.forEach((l, i) => {
      html += `<div class="line" id="line-${i}" onclick="speakLine(${idx}, ${i})">
        <span class="role" style="color:${getRoleColor(l.r)}">${l.r}:</span> 
        <span class="en">${l.e}</span>
        <span class="vi ${isViVisible?'':'hidden'}">${l.v}</span>
      </div>`;
    });
    html += `</div>
      <button class="next-btn" onclick="loadSlide(${idx+1})" style="display:block">Ti·∫øp theo ‚ûú</button>
    `;
  }
  
  // TYPE: READING
  else if (data.type === 'reading') {
    html += `<div class="scroll-content">`;
    data.content.forEach(p => {
      html += `<p style="margin-bottom:12px">
        <span class="en" style="font-weight:600">${p.e}</span>
        <span class="vi ${isViVisible?'':'hidden'}">${p.v}</span>
      </p>`;
    });
    html += `</div>`;
    if(data.qs) {
       data.qs.forEach((q, qIdx) => { html += renderQuizItem(idx, q, qIdx); });
    }
    if(idx < DATA.length - 1) {
        html += `<button class="next-btn" style="display:block" onclick="loadSlide(${idx+1})">Chuy·ªÉn ph·∫ßn ti·∫øp theo ‚ûú</button>`;
    }
  }

  // TYPE: QUIZ
  else if (data.type === 'quiz') {
    data.qs.forEach((q, qIdx) => { html += renderQuizItem(idx, q, qIdx); });
    if (idx < DATA.length - 1) {
      html += `<button class="next-btn" style="display:block" onclick="loadSlide(${idx+1})">Chuy·ªÉn ph·∫ßn ti·∫øp theo ‚ûú</button>`;
    } else {
      html += `<div style="text-align:center; margin-top:20px; color:#27ae60; font-weight:bold; font-size:18px">üéâ CH√öC M·ª™NG! B·∫†N ƒê√É HO√ÄN TH√ÄNH UNIT 10! üéâ</div>`;
    }
  }

  html += `</div>`;
  main.innerHTML = html;
}

function renderQuizItem(idx, q, qIdx) {
    // SHUFFLE OPTIONS
    let options = q.o.map((opt, i) => ({...opt, originalIndex: i}));
    for (let i = options.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [options[i], options[j]] = [options[j], options[i]];
    }

    let itemHtml = `
      <div class="q-block" id="q-${idx}-${qIdx}">
        <div class="q-text">${qIdx+1}. ${q.q}</div>
        <div class="q-vi ${isViVisible?'':'hidden'}">${q.v}</div>
        <div class="opts-grid">`;
    options.forEach((opt, oIdx) => {
      itemHtml += `<button class="opt-btn" onclick="checkAns(this, ${idx}, ${qIdx}, ${opt.originalIndex}, ${q.a})">
        <span>${opt.t}</span>
        <span class="opt-sub ${isViVisible?'':'hidden'}">${opt.v}</span>
      </button>`;
    });
    itemHtml += `</div>
        <div class="expl-box" id="expl-${idx}-${qIdx}">
          <span class="expl-title">GI·∫¢I TH√çCH CHI TI·∫æT:</span> ${q.e}
        </div>
      </div>
    `;
    return itemHtml;
}

/* --- LOGIC --- */
function checkAns(btn, sIdx, qIdx, uAns, cAns) {
  const parent = btn.parentElement;
  const btns = parent.getElementsByClassName('opt-btn');
  for(let b of btns) b.style.pointerEvents = 'none';

  const explBox = document.getElementById(`expl-${sIdx}-${qIdx}`);
  explBox.style.display = 'block';

  if (uAns === cAns) {
    btn.classList.add('correct');
    score += 10;
    document.getElementById('score').innerText = score;
    setTimeout(() => {
        // Auto scroll to next question or explanation
        explBox.scrollIntoView({behavior: "smooth", block: "center"});
    }, 500);
  } else {
    btn.classList.add('wrong');
  }
  
  answeredQ++;
  document.getElementById('qCount').innerText = Math.min(answeredQ, totalQ);
}

function getRoleColor(role) {
  if(['Mr Tan','Nam','Mr Lam','Mark'].includes(role)) return '#2980B9'; // Blue
  if(['Lan','Mai','Ha','Student 1','Student 2'].includes(role)) return '#C0392B'; // Red
  return '#D35400';
}

/* --- AUDIO & TTS --- */
function toggleMusic() {
  isMusicOn = !isMusicOn;
  const btn = document.getElementById('btnMusic');
  btn.innerText = isMusicOn ? "üéµ Nh·∫°c: ON" : "üéµ Nh·∫°c: OFF";
  btn.classList.toggle('music-on', isMusicOn);

  if (isMusicOn) {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (audioCtx.state === 'suspended') audioCtx.resume();
    playBeat();
  } else {
    clearInterval(musicInterval);
  }
}

function playBeat() {
  // Energetic Techno Beat
  const notes = [130.81, 146.83, 164.81, 196.00]; 
  let step = 0;
  
  function tick() {
    if (!isMusicOn) return;
    const now = audioCtx.currentTime;
    
    if (step % 2 === 0) {
      let osc = audioCtx.createOscillator();
      let g = audioCtx.createGain();
      osc.type = 'triangle';
      osc.frequency.value = notes[Math.floor(Math.random()*notes.length)] * 2;
      g.gain.setValueAtTime(0, now);
      g.gain.linearRampToValueAtTime(0.04, now + 0.05);
      g.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
      osc.connect(g); g.connect(audioCtx.destination);
      osc.start(now); osc.stop(now + 0.4);
    }
    if (step % 4 === 0) {
       let kick = audioCtx.createOscillator();
       let kg = audioCtx.createGain();
       kick.frequency.setValueAtTime(150, now);
       kick.frequency.exponentialRampToValueAtTime(0.01, now + 0.5);
       kg.gain.setValueAtTime(0.5, now);
       kg.gain.exponentialRampToValueAtTime(0.001, now + 0.5);
       kick.connect(kg); kg.connect(audioCtx.destination);
       kick.start(now); kick.stop(now + 0.5);
    }
    step++;
  }
  musicInterval = setInterval(tick, 180);
}

function playScript(idx) {
  if(isMusicOn) clearInterval(musicInterval); 
  const script = DATA[idx].script;
  synth.cancel();
  let i = 0;
  
  function next() {
    if (i >= script.length) {
      if(isMusicOn) playBeat();
      return;
    }
    const line = script[i];
    const u = new SpeechSynthesisUtterance(line.e);
    
    const voices = synth.getVoices();
    const isFemale = ['Lan','Mi','Mai','Ha'].includes(line.r);
    u.voice = voices.find(v => v.name.includes(isFemale ? 'Female' : 'Male')) || voices[0];
    u.rate = 0.9;

    document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
    const el = document.getElementById(`line-${i}`);
    if(el) {
      el.classList.add('active');
      el.scrollIntoView({behavior:"smooth", block:"center"});
    }

    u.onend = () => { i++; next(); };
    synth.speak(u);
  }
  next();
}

function stopAudio() {
  synth.cancel();
  if(isMusicOn) playBeat();
}

function speakLine(sIdx, lIdx) {
  synth.cancel();
  const line = DATA[sIdx].script[lIdx];
  const u = new SpeechSynthesisUtterance(line.e);
  const voices = synth.getVoices();
  const isFemale = ['Lan','Mi','Mai','Ha'].includes(line.r);
  u.voice = voices.find(v => v.name.includes(isFemale ? 'Female' : 'Male')) || voices[0];
  synth.speak(u);
  
  document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
  document.getElementById(`line-${lIdx}`).classList.add('active');
}

function toggleVi() {
  isViVisible = !isViVisible;
  document.querySelectorAll('.vi, .q-vi, .opt-sub').forEach(el => el.classList.toggle('hidden', !isViVisible));
  const btn = document.getElementById('btnVi');
  btn.classList.toggle('active');
  btn.innerText = isViVisible ? "üáªüá≥ D·ªãch: ON" : "üáªüá≥ D·ªãch: OFF";
}

if (speechSynthesis.onvoiceschanged !== undefined) {
  speechSynthesis.onvoiceschanged = () => { voices = synth.getVoices(); };
}

</script>
</body>
</html>